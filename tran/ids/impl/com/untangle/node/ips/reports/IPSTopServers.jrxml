<?xml version="1.0" encoding="UTF-8"  ?>
<!-- Created with iReport - A designer for JasperReports -->
<!DOCTYPE jasperReport PUBLIC "//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">
<jasperReport
    name="IPSTopServers"
    columnCount="1"
    printOrder="Vertical"
    orientation="Portrait"
    pageWidth="360"
    pageHeight="791"
    columnWidth="360"
    columnSpacing="0"
    leftMargin="0"
    rightMargin="0"
    topMargin="0"
    bottomMargin="0"
    whenNoDataType="AllSectionsNoDetail"
    isFloatColumnFooter="true"
    isTitleNewPage="false"
    isSummaryNewPage="false">
    <property name="com.jasperassistant.designer.HGuides" value="91,93,154,154,156,156,233,233,235" />
    <property name="com.jasperassistant.designer.GridWidth" value="12" />
    <property name="com.jasperassistant.designer.GridHeight" value="12" />
    <property name="com.jasperassistant.designer.Rulers" value="true" />
    <property name="com.jasperassistant.designer.SnapToGrid" value="true" />
    <property name="com.jasperassistant.designer.Margins" value="true" />
    <property name="com.jasperassistant.designer.Grid" value="true" />
    <property name="com.jasperassistant.designer.SnapToGuides" value="true" />
    <property name="ireport.scriptlethandling" value="0" />
    <import value="java.util.*" />
    <import value="net.sf.jasperreports.engine.*" />
    <import value="net.sf.jasperreports.engine.data.*" />
    <parameter name="startTime" isForPrompting="true" class="java.sql.Timestamp"/>
    <parameter name="endTime" isForPrompting="true" class="java.sql.Timestamp"/>
    <queryString><![CDATA[
SELECT rule_sid,
       c_server_addr AS SERVER,
       COUNT(CASE blocked WHEN true THEN 1 ELSE NULL END) AS BLOCKED,
       COUNT(CASE blocked WHEN false THEN 1 ELSE NULL END) AS PASSED,
       COUNT(c_server_addr) AS TOTAL_ACTIONS
  FROM tr_ids_evt evt
         JOIN pl_endp endp ON (evt.pl_endp_id = endp.event_id)
  WHERE evt.time_stamp >= $P{startTime}
    AND evt.time_stamp < $P{endTime}
  GROUP BY rule_sid, c_server_addr
  ORDER BY TOTAL_ACTIONS DESC
  LIMIT 15
         ]]></queryString>
    <field name="RULE_SID" class="java.lang.Long"/>
    <field name="SERVER" class="java.lang.String"/>
    <field name="BLOCKED" class="java.lang.Long"/>
    <field name="PASSED" class="java.lang.Long"/>
    <field name="TOTAL_ACTIONS" class="java.lang.Long"/>
    <variable name="RANK" class="java.lang.Integer" resetType="Report" calculation="Count">
        <variableExpression><![CDATA[$F{RULE_SID}]]></variableExpression>
    </variable>
    <background>
        <band height="0"  isSplitAllowed="true" >
        </band>
    </background>
    <title>
        <band height="14"  isSplitAllowed="true" >
            <staticText>
                <reportElement
                    mode="Opaque"
                    x="90"
                    y="0"
                    width="169"
                    height="14"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="staticText"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="SansSerif" pdfFontName="Helvetica" size="10" isBold="true" isItalic="false" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <text><![CDATA[Top 15 Server IPS Events]]></text>
            </staticText>
        </band>
    </title>
    <pageHeader>
        <band height="13"  isSplitAllowed="true" >
            <staticText>
                <reportElement
                    mode="Opaque"
                    x="44"
                    y="0"
                    width="80"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="staticText"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="SansSerif" pdfFontName="Helvetica" size="9" isBold="false" isItalic="true" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <text><![CDATA[Server]]></text>
            </staticText>
            <staticText>
                <reportElement
                    mode="Opaque"
                    x="2"
                    y="0"
                    width="40"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="staticText-2"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="SansSerif" pdfFontName="Helvetica" size="9" isBold="false" isItalic="true" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <text><![CDATA[SID]]></text>
            </staticText>
            <staticText>
                <reportElement
                    mode="Opaque"
                    x="213"
                    y="0"
                    width="85"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="staticText-4"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="SansSerif" pdfFontName="Helvetica" size="9" isBold="false" isItalic="true" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <text><![CDATA[Blocked]]></text>
            </staticText>
            <staticText>
                <reportElement
                    mode="Opaque"
                    x="300"
                    y="0"
                    width="85"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="staticText-5"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="SansSerif" pdfFontName="Helvetica" size="9" isBold="false" isItalic="true" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <text><![CDATA[Total Actions]]></text>
            </staticText>
            <staticText>
                <reportElement
                    mode="Opaque"
                    x="126"
                    y="0"
                    width="85"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="staticText-6"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="SansSerif" pdfFontName="Helvetica" size="9" isBold="false" isItalic="true" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <text><![CDATA[Passed]]></text>
            </staticText>
        </band>
    </pageHeader>
    <columnHeader>
        <band height="0"  isSplitAllowed="true" >
        </band>
    </columnHeader>
    <detail>
        <band height="13"  isSplitAllowed="true" >
<!--
            <printWhenExpression><![CDATA[new Boolean($V{RANK}.intValue() <= 15)]]></printWhenExpression>
-->
            <textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
                <reportElement
                    mode="Opaque"
                    x="44"
                    y="0"
                    width="80"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="textField"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="SansSerif" pdfFontName="Helvetica" size="9" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <textFieldExpression   class="java.lang.String"><![CDATA[$F{SERVER}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
                <reportElement
                    mode="Opaque"
                    x="2"
                    y="0"
                    width="40"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="textField-1"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="SansSerif" pdfFontName="Helvetica" size="9" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <textFieldExpression   class="java.lang.Long"><![CDATA[$F{RULE_SID}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
                <reportElement
                    mode="Opaque"
                    x="213"
                    y="0"
                    width="85"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="textField-3"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="Monospaced" pdfFontName="Helvetica" size="9" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <textFieldExpression   class="java.lang.Long"><![CDATA[$F{BLOCKED}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
                <reportElement
                    mode="Opaque"
                    x="300"
                    y="0"
                    width="85"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="textField-4"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="Monospaced" pdfFontName="Helvetica" size="9" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <textFieldExpression   class="java.lang.Long"><![CDATA[$F{TOTAL_ACTIONS}]]></textFieldExpression>
            </textField>
            <textField isStretchWithOverflow="false" pattern="" isBlankWhenNull="false" evaluationTime="Now" hyperlinkType="None"  hyperlinkTarget="Self" >
                <reportElement
                    mode="Opaque"
                    x="126"
                    y="0"
                    width="85"
                    height="13"
                    forecolor="#000000"
                    backcolor="#FFFFFF"
                    key="textField-5"
                    stretchType="NoStretch"
                    positionType="Float"
                    isPrintRepeatedValues="true"
                    isRemoveLineWhenBlank="false"
                    isPrintInFirstWholeBand="false"
                    isPrintWhenDetailOverflows="false"/>
                <box topBorder="None" topBorderColor="#000000" leftBorder="None" leftBorderColor="#000000" rightBorder="None" rightBorderColor="#FFFFFF" bottomBorder="None" bottomBorderColor="#000000"/>
                <textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single">
                    <font fontName="Monospaced" pdfFontName="Helvetica" size="9" isBold="false" isItalic="false" isUnderline="false" isPdfEmbedded ="false" pdfEncoding ="Cp1252" isStrikeThrough="false" />
                </textElement>
            <textFieldExpression   class="java.lang.Long"><![CDATA[$F{PASSED}]]></textFieldExpression>
            </textField>
        </band>
    </detail>
    <columnFooter>
        <band height="13"  isSplitAllowed="true" >
        </band>
    </columnFooter>
    <pageFooter>
        <band height="0"  isSplitAllowed="true" >
        </band>
    </pageFooter>
    <summary>
        <band height="0"  isSplitAllowed="true" >
        </band>
    </summary>
</jasperReport>
