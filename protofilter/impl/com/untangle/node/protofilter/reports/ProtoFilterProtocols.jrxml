<?xml version="1.0" encoding="UTF-8"?>
<!-- Created using an evaluation version of JasperAssistant (http://www.jasperassistant.com) -->
<!DOCTYPE jasperReport PUBLIC "-//JasperReports//DTD Report Design//EN" "http://jasperreports.sourceforge.net/dtds/jasperreport.dtd">

<jasperReport name="ProtoFilterProtocols" whenNoDataType="AllSectionsNoDetail" pageWidth="276" pageHeight="791" columnWidth="276" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" isFloatColumnFooter="true">
  <import value="java.util.*"/>
  <import value="net.sf.jasperreports.engine.*"/>
  <import value="net.sf.jasperreports.engine.data.*"/>
  <parameter name="startTime" class="java.sql.Timestamp">
  </parameter>
  <parameter name="endTime" class="java.sql.Timestamp">
  </parameter>
  <queryString><![CDATA[
SELECT protocol, sum(s2p_bytes + p2s_bytes) AS size, total_size
FROM (SELECT sum(s2p_bytes + p2s_bytes) AS total_size FROM tr_protofilter_evt AS evt
      JOIN pl_stats stats ON stats.pl_endp_id = evt.pl_endp_id
      WHERE evt.time_stamp > $P{startTime} AND evt.time_stamp < $P{endTime}) AS total,
     tr_protofilter_evt AS evt
JOIN pl_stats stats ON stats.pl_endp_id = evt.pl_endp_id
WHERE evt.time_stamp > $P{startTime}
AND evt.time_stamp < $P{endTime}
GROUP BY protocol, total_size
ORDER BY size DESC
  ]]></queryString>
  <field name="protocol" class="java.lang.String">
  </field>
  <field name="size" class="java.lang.Long">
  </field>
  <field name="total_size" class="java.lang.Long">
  </field>
  <variable name="n" class="java.lang.Integer" calculation="Count">
    <variableExpression><![CDATA[$F{protocol}]]></variableExpression>
  </variable>
  <background>
    <band>
    </band>
  </background>
  <title>
    <band height="14">
      <staticText>
        <reportElement key="staticText" positionType="Float" mode="Opaque" x="53" y="0" width="169" height="14"/>
        <box topBorder="None" topBorderColor="#0" leftBorder="None" leftBorderColor="#0" bottomBorder="None" bottomBorderColor="#0" rightBorder="None" rightBorderColor="#ffffff"/>
        <textElement textAlignment="Center">
          <font fontName="SansSerif" size="10" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
        </textElement>
        <text><![CDATA[Logged Protocols]]></text>
      </staticText>
    </band>
  </title>
  <pageHeader>
    <band height="13">
      <staticText>
        <reportElement key="staticText" positionType="Float" mode="Opaque" x="0" y="0" width="169" height="13"/>
        <box topBorder="None" topBorderColor="#0" leftBorder="None" leftBorderColor="#0" bottomBorder="None" bottomBorderColor="#0" rightBorder="None" rightBorderColor="#ffffff"/>
        <textElement>
          <font fontName="SansSerif" size="9" isBold="false" isItalic="true" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
        </textElement>
        <text><![CDATA[Protocol]]></text>
      </staticText>
      <staticText>
        <reportElement key="staticText" positionType="Float" mode="Opaque" x="172" y="0" width="62" height="13"/>
        <box topBorder="None" topBorderColor="#0" leftBorder="None" leftBorderColor="#0" bottomBorder="None" bottomBorderColor="#0" rightBorder="None" rightBorderColor="#ffffff"/>
        <textElement textAlignment="Right">
          <font fontName="SansSerif" size="9" isBold="false" isItalic="true" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
        </textElement>
        <text><![CDATA[Size (MB)]]></text>
      </staticText>
      <staticText>
        <reportElement positionType="Float" x="234" y="0" width="42" height="13"/>
        <textElement textAlignment="Right">
          <font fontName="SansSerif" size="9" isItalic="true"/>
        </textElement>
        <text><![CDATA[%Size]]></text>
      </staticText>
    </band>
  </pageHeader>
  <columnHeader>
    <band>
    </band>
  </columnHeader>
  <detail>
    <band height="13">
      <printWhenExpression><![CDATA[new Boolean($V{n}.intValue() < 20)]]></printWhenExpression>
      <textField pattern="">
        <reportElement key="textField" positionType="Float" mode="Opaque" x="172" y="0" width="62" height="13"/>
        <box topBorderColor="#0" leftBorderColor="#0" bottomBorderColor="#0" rightBorderColor="#ffffff"/>
        <textElement textAlignment="Right">
          <font fontName="Monospaced" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[new Formatter().format("%,.2f", new Object[] { new Double($F{size}.doubleValue() / 1048576) }).toString()]]></textFieldExpression>
      </textField>
      <textField pattern="">
        <reportElement key="textField" positionType="Float" mode="Opaque" x="0" y="0" width="169" height="13"/>
        <box topBorderColor="#0" leftBorderColor="#0" bottomBorderColor="#0" rightBorderColor="#ffffff"/>
        <textElement>
          <font fontName="SansSerif" size="9" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[$F{protocol}]]></textFieldExpression>
      </textField>
      <textField>
        <reportElement positionType="Float" x="234" y="0" width="42" height="13"/>
        <textElement textAlignment="Right">
          <font fontName="Monospaced" size="9" isItalic="true"/>
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[Math.round($F{size}.doubleValue() / $F{total_size}.doubleValue() * 100) + "%"]]></textFieldExpression>
      </textField>
    </band>
  </detail>
  <columnFooter>
    <band height="13">
      <textField pattern="">
        <reportElement key="textField" positionType="Float" mode="Opaque" x="172" y="0" width="62" height="13"/>
        <box topBorder="None" topBorderColor="#0" leftBorder="None" leftBorderColor="#0" bottomBorder="None" bottomBorderColor="#0" rightBorder="None" rightBorderColor="#ffffff"/>
        <textElement textAlignment="Right">
          <font fontName="Monospaced" size="9" isBold="true" isItalic="true" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
        </textElement>
        <textFieldExpression class="java.lang.String"><![CDATA[new Formatter().format("%,.2f", new Object[] { new Double($F{total_size}.doubleValue() / 1048576)}).toString()]]></textFieldExpression>
      </textField>
      <staticText>
        <reportElement key="staticText" positionType="Float" mode="Opaque" x="0" y="0" width="169" height="13"/>
        <box topBorder="None" topBorderColor="#0" leftBorder="None" leftBorderColor="#0" bottomBorder="None" bottomBorderColor="#0" rightBorder="None" rightBorderColor="#ffffff"/>
        <textElement>
          <font fontName="SansSerif" size="9" isBold="true" isItalic="true" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
        </textElement>
        <text><![CDATA[Totals:]]></text>
      </staticText>
      <staticText>
        <reportElement positionType="Float" x="234" y="0" width="42" height="13"/>
        <textElement textAlignment="Right">
          <font fontName="Monospaced" size="9" isBold="true" isItalic="true"/>
        </textElement>
        <text><![CDATA[100%]]></text>
      </staticText>
    </band>
  </columnFooter>
  <pageFooter>
    <band height="30">
    </band>
  </pageFooter>
  <summary>
    <band>
    </band>
  </summary>
</jasperReport>
